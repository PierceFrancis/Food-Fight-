extends Area2D

signal picked_up(player_id: int)

var player_inside: Node = null  # reference to the player currently inside

func _ready() -> void:
	var manager = get_tree().root.get_node("GameManager") # adjust if needed
	self.picked_up.connect(manager.add_pickup)

func _on_body_entered(body: Node) -> void:
	if body.is_in_group("player1") or body.is_in_group("player2"):
		player_inside = body

func _on_body_exited(body: Node) -> void:
	if body == player_inside:
		player_inside = null

func _process(delta: float) -> void:
	if player_inside:
		if player_inside.is_in_group("player1") and Input.is_action_just_pressed("action_button_p2") and GameManager.pickups_p1 == 0:
			picked_up.emit(1)
			queue_free()
		elif player_inside.is_in_group("player2") and Input.is_action_just_pressed("action_button") and GameManager.pickups_p2 == 0:
			picked_up.emit(2)
			queue_free()

